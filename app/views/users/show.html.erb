<% title @user.full_name + '\'s Profile' %>

<div class="row p-3" style="display: flex; align-items: center">
  <% if @user.profile_image.present? %>
    <%= image_tag attachment_url(@user, :profile_image, :fill, 100, 100, fallback: 'defaultprofileimage'), class: 'usershowprofileimage' %>
  <% elsif @user.default_image.present? %>
    <%= image_tag @user.default_image, class: "usershowprofileimage"%>
    <%#= image_tag attachment_url(@user, :default_image, :fill, 100, 100, fallback: 'defaultprofileimage'), class: 'usershowprofileimage' %>
    <!-- <img src="<%=@user.default_image%>" class="usershowprofileimage"> -->
  <% end %>
  <div>
    <h1><%=@user.full_name%>'s Profile</h1>
    <% if current_user&.following?(@user) %>
      <%= link_to 'Unfollow', relationship_path(current_user.active_relationships.find_by(followed_id: @user.id)), method: :delete, class: 'btn btn-outline-success btn-sm follow-button' %> (<%= pluralize(@user.followers.count, 'follower') %>)
    <% else %>
      <%# if current_user != @user %>
      <% if can?(:follow, @user) %>
        <%= link_to 'Follow', relationships_path(@user.id), method: :post, class: 'btn btn-success btn-sm follow-button' %>
      <% end %>
      (<%= pluralize(@user.followers.count, 'follower') %>)
    <% end %>
  </div>
</div>


<ul class="nav nav-tabs" id="user-show-tab" role="tablist">
  <li class="nav-item">
    <a class="nav-link active" id="home-tab" data-toggle="tab" href="#home">Overview</a>
  </li>
  <!-- <li class="nav-item">
    <a class="nav-link" id="all-tab" data-toggle="tab" href="#all" role="tab">All Contributions</a>
  </li> -->
  <li class="nav-item">
    <a class="nav-link" id="posts-tab" data-toggle="tab" href="#posts">Posts</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" id="media-tab" data-toggle="tab" href="#media">Media</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" id="reviewlists-tab" data-toggle="tab" href="#reviewlists">Review List</a>
  </li>
</ul>
<div class="tab-content" id="user-show-tab-content">
  <div class="tab-pane p-2 fade show active" id="home" role="tabpanel">

    <div class="row">
      <div class="col-md-6">
        <div class="border p-3 mr-1">
          <strong>First Name:</strong> <%= @user.first_name %><br />
          <strong>Last Name:</strong> <%= @user.last_name %><br />
          <strong>Interests:</strong> <%= @user.tag_list %><br />
          <strong>Email:</strong> <%= @user.email %><br />
          <% if can?(:crud, @user) %>
            <%= link_to "Edit Profile", edit_user_registration_path %>
          <% end %>
        </div>
      </div>
      <div class="col-md-6">
        <div class="border p-3 ml-1">
          <strong>All Content:</strong> <%= @user.contributions.size %><br />
          <strong>Posts:</strong> <%= @user.posts.size %><br />
          <strong>Images:</strong> <%= @user.images.size %><br />
          <strong>Audios:</strong> <%= @user.audios.size %><br />
          <strong>Videos:</strong> <%= @user.videos.size %><br />
        </div>
      </div>
    </div>

  </div>
  <!-- <div class="tab-pane p-2 fade" id="all" role="tabpanel">

    <h3>All Contributions</h3>
    <% @user.contributions.each do |c| %>
    <p>
      <%= link_to c.title, c %>
    </p>
    <%end%>

  </div> -->
  <div class="tab-pane p-2 fade" id="posts" role="tabpanel">
    <%= render partial: 'posts/posts_list', locals: { posts: @user.posts.created_at_desc }%>
    <%#= render partial: 'shared/pagination', locals: {model: @user.posts.created_at_desc } %>
  </div>
  <div class="tab-pane p-2 fade" id="media" role="tabpanel">

    <h3>All Media (By Most Recent)</h3>
    <% @user.media.created_at_desc.each do |m| %>
    <p>
      <%= link_to m.title, m %>
    </p>
    <%end%>
    <h3>Images</h3>
    <% @user.images.each do |m| %>
    <p>
      <%= link_to m.title, m %>
    </p>
    <%end%>
    <h3>Audios</h3>
    <% @user.audios.each do |m| %>
    <p>
      <%= link_to m.title, m %>
    </p>
    <%end%>
    <h3>Videos</h3>
    <% @user.videos.each do |m| %>
    <p>
      <%= link_to m.title, m %>
    </p>
    <%end%>

  </div>
  <div class="tab-pane p-2 fade" id="reviewlists" role="tabpanel">
    <% @user.reviewlists.each do |item| %>
    <%=link_to item.reviewable.title, item.reviewable %><br />
    <% end %>
  </div>

</div>
